<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SimSpin.jl Documentation · My Documentation</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">My Documentation</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>SimSpin.jl Documentation</a><ul class="internal"><li><a class="tocitem" href="#Usage-1"><span>Usage</span></a></li><li><a class="tocitem" href="#Functions-1"><span>Functions</span></a></li><li><a class="tocitem" href="#Type-Constructors-1"><span>Type Constructors</span></a></li><li><a class="tocitem" href="#Multi-Threading-1"><span>Multi-Threading</span></a></li><li><a class="tocitem" href="#Data-Input-Format-1"><span>Data Input Format</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>SimSpin.jl Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SimSpin.jl Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kateharborne/SimSpin-Julia/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SimSpin.jl-Documentation-1"><a class="docs-heading-anchor" href="#SimSpin.jl-Documentation-1">SimSpin.jl Documentation</a><a class="docs-heading-anchor-permalink" href="#SimSpin.jl-Documentation-1" title="Permalink"></a></h1><h2 id="Usage-1"><a class="docs-heading-anchor" href="#Usage-1">Usage</a><a class="docs-heading-anchor-permalink" href="#Usage-1" title="Permalink"></a></h2><p>For the installation procedure of the SimSpin package please follow the installation instructions on the package&#39;s <a href="https://github.com/kateharborne/SimSpin-Julia"><em>README</em></a>.</p><p>Once installed, a kinematic datacube for the example galaxy observed from redshift 0.05 and inclined at 30 degrees from face on can be built using the following procedure:</p><pre><code class="language-none">&gt; sim_data = SimSpin.sim_data(&quot;path/to/SimSpin/example/SimSpin_example.hdf5&quot;)
&gt; datacube = SimSpin.build_datacube(sim_data, z = 0.05, inc_deg = 30)</code></pre><h2 id="Functions-1"><a class="docs-heading-anchor" href="#Functions-1">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SimSpin.build_datacube" href="#SimSpin.build_datacube"><code>SimSpin.build_datacube</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">build_datacube(galaxy_data;
                r200 = 200,
                z = 0.05,
                fov = 15.,
                ap_shape = &quot;circular&quot;,
                central_wvl = 4800,
                lsf_fwhm = 2.65,
                pixel_sscale = 0.5,
                pixel_vscale = 1.04,
                inc_deg = 70,
                filter = &quot;r&quot;,
                blur = Blur(&quot;none&quot;))</code></pre><p>Returns a simulated ifu datacube for input, <code>galaxy_data</code>, an array of <code>Particle</code>. Observational parameters specified as keyword arguments.</p><p>Keyword arguments (optional):</p><pre><code class="language-none">r200            The virial radius specified in the simulation, kpc.
z               The projected redshift at which the observation is made.
fov             The field of view of the IFU, diameter in arcseconds.
ap_shape        The shape of the field of view, with options &quot;circular&quot;, &quot;square&quot; or &quot;hexagonal&quot;.
central_wvl     The central filter wavelength used for the observation, given in angstroms.
lsf_fwhm        The line spread function full-width half-max, given in angstroms.
pixel_sscale    The corresponding spatial pixel scale associated with a given telescope output in arcseconds.
pixel_vscale    The corresponding velocity pixel scale associated with a given telescope filter output in angstroms.
inc_deg         The inclination at which to observe the galaxy in degrees.
filter          If particles type is ssp, the filter within which the SED is generated. Options include &quot;r&quot; and &quot;g&quot;  for SDSS-r and SDSS-g bands respectively.
blur            Specified to apply observational seeing effects to the cube. Use `Blur()` function to create blur profile. If omitted no blurring occurs.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin-Julia/blob/277150c73ff09ea911a019cea516ff7489287ee0/src/functions/build_datacube.jl#L5-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.flux_grid" href="#SimSpin.flux_grid"><code>SimSpin.flux_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">flux_grid(parts_in_cell,
            ap_region,
            sbin,
            vbin,
            redshift,
            filter)</code></pre><p>Computes the fluxes for each element of the IFU data-cube.</p><p>The purpose of this function is to construct the mock flux values within each cell of the IFU cube. It accepts output parameters from <code>obs_data_prep()</code> and returns a 3D array containing the flux at each cell position due to contributions from the particles. If ssd particles are supplied, an SED is generated in each cell using ProSpect. Else, the luminosity in each cell is converted to flux.</p><p>Parameters:</p><pre><code class="language-none">parts_in_cell       1D array of the particles corresponding to each element in the IFU data-cube.
ap_region           The aperture region mask used to remove flux outside of the specified aperture.
sbin                The number of spatial bins in the aperture.
vbin                The number of velocity bins in the flux grid.
redshift            The projected redshift at which the observation is made.
filter              If ssp particles are supplied, the filter within which the SED is generated.
                    Options include &quot;r&quot; and &quot;g&quot;  for SDSS-r and SDSS-g bands respectively.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin-Julia/blob/277150c73ff09ea911a019cea516ff7489287ee0/src/functions/flux_grid.jl#L7-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.ifu_cube" href="#SimSpin.ifu_cube"><code>SimSpin.ifu_cube</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ifu_cube(flux_grid,
            parts_in_cell,
            sbin,
            vbin,
            vseq,
            lsf_size)</code></pre><p>The purpose of this function is to construct an IFU data cube. It accepts the flux<em>grid output by the `flux</em>grid()` function and returns a similar, IFU-like, 3D array where each particle&#39;s flux contributes a Gaussian distribution in the velocity axis.</p><p>Parameters:</p><pre><code class="language-none">flux_grid       Flux grid output by `flux_grid()`
parts_in_cell   1D array of the particles corresponding to each element in the IFU data-cube.
sbin            The number of spatial bins in the aperture.
vbin            The number of velocity bins in the flux grid.
vseq            The bounds of each velocity bin in the flux grid.
lsf_size        The Gaussian standard deviation of the line spread function in km/s.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin-Julia/blob/277150c73ff09ea911a019cea516ff7489287ee0/src/functions/ifu_cube.jl#L7-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.obs_data_prep" href="#SimSpin.obs_data_prep"><code>SimSpin.obs_data_prep</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">obs_data_prep(galaxy_data;
                r200 = 200,
                z = 0.05,
                fov = 15.,
                ap_shape = &quot;circular&quot;,
                central_wvl = 4800,
                lsf_fwhm = 2.65,
                pixel_sscale = 0.5,
                pixel_vscale = 1.04,
                inc_deg = 70)</code></pre><p>This function prepares the particle data for a given observation.</p><p>Returns:</p><pre><code class="language-none">galaxy_data         Array of particle data formatted for the observation specified by the parameters.
parts_in_cell       3D array of the particles corresponding to each element in the IFU data-cube.
ap_region           The aperture region mask used to remove flux outside of the specified aperture.
sbin                The number of spatial bins in the aperture.
vbin                The number of velocity bins in the flux grid.
vseq                The bounds of each velocity bin in the flux grid.
lsf_size            The Gaussian standard deviation of the line spread function in km/s.
ang_size            The angular size given redshift z in kpc
sbinsize            The spatial bin size in kpc per bin</code></pre><p>Keyword arguments (optional):</p><pre><code class="language-none">r200            The virial radius specified in the simulation, kpc.
z               The projected redshift at which the observation is made.
fov             The field of view of the IFU, diameter in arcseconds.
ap_shape        The shape of the field of view, with options &quot;circular&quot;, &quot;square&quot; or &quot;hexagonal&quot;.
central_wvl     The central filter wavelength used for the observation, given in angstroms.
lsf_fwhm        The line spread function full-width half-max, given in angstroms.
pixel_sscale    The corresponding spatial pixel scale associated with a given telescope output in arcseconds.
pixel_vscale    The corresponding velocity pixel scale associated with a given telescope filter output in angstroms.
inc_deg         The inclination at which to observe the galaxy in degrees.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin-Julia/blob/277150c73ff09ea911a019cea516ff7489287ee0/src/functions/obs_data_prep.jl#L5-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.sim_data" href="#SimSpin.sim_data"><code>SimSpin.sim_data</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sim_data(filename;
        pytpe = [],
        ssp = false)</code></pre><p>Reads in a <a href="https://github.com/kateharborne/create_SimSpinFile">SimSpin format</a> HDF5 file at location, <code>filename</code>. Returns array of Sim_particles.</p><p>Keyword arguments (optional):</p><pre><code class="language-none">ptype       A vector of the particles types to be read in e.g. ptype = [1,3].
            If omitted all particles types will be read.
ssp         Boolean value to use ssp particle information.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin-Julia/blob/277150c73ff09ea911a019cea516ff7489287ee0/src/io/sim_data.jl#L7-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.sim_analysis" href="#SimSpin.sim_analysis"><code>SimSpin.sim_analysis</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sim_analysis(sim_data;
                bin_type=&quot;r&quot;,
                rmax=200,
                rbin=200,
                dm_profile=nothing)</code></pre><p>The purpose of this function is to calculate the kinematic properties of a simulated galaxy, specifically the velocity and dispersion of particles within certain user defined bins. The user must specify which direction they wish to study the kinematics using <code>bin_type</code> (where <code>r</code> specifies out radial 3D spherical bins, <code>cr</code> specifies radial 2D circular bins, and <code>z</code> specifies directly in 1D out of the plane of the galaxy). The default, <code>bin_type = &quot;r&quot;</code> will return a comprehensive list of the simulation&#39;s kinematic properties (i.e. contained radial mass and densities, velocities, velocity dispersions, anisotropy, rotational and circular velocities and spin parameter). Other options for <code>bin_type</code> will not contain the anisotropy, rotational and circular velocities or spin parameter as these are only physical when defined using 3D spherical shells.</p><pre><code class="language-none">Keyword arguments (optional):

    bin_type    The direction in which to bin the simulation model - `r` (default) bins</code></pre><p>radially in 3D spherical shells, <code>cr</code> bins radially in 2D circular rings, <code>z</code> bins in 1D off the plane of the galaxy.         rmax        The maximum radial coordinate considered within the simulated galaxy in kpc.         rbin        The number of radial bins considered.         dm<em>profile  If dark matter particles are not included in the analysis, this option allows you to use the DM profile for the mass distribution such that the circular velocity can be correctly determined. Options include nothing (default), `Dict(&quot;profile&quot;=&gt;&quot;NFW&quot;, &quot;dm</em>vm&quot;=&gt;186.9, &quot;dm<em>a&quot;=&gt;34.5, &quot;dm</em>rhof&quot;=&gt;0.035)<code>- where dm_vm is the virial mass, dm_a is the scale radius, and dm_rhof is the density evaluated at the flattening radius - and</code>Dict(&quot;profile&quot;=&gt;&quot;Hernquist&quot;, &quot;dm<em>mass&quot;=&gt;184.9, &quot;dm</em>a&quot;=&gt;34.5)` - where dm<em>mass is the total mass of the dark matter component and dm</em>a is the scale radius of the halo.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin-Julia/blob/277150c73ff09ea911a019cea516ff7489287ee0/src/functions/sim_analysis.jl#L5-L37">source</a></section></article><h2 id="Type-Constructors-1"><a class="docs-heading-anchor" href="#Type-Constructors-1">Type Constructors</a><a class="docs-heading-anchor-permalink" href="#Type-Constructors-1" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Gaussian_blur</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Moffat_blur</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SimSpin.Hernquist" href="#SimSpin.Hernquist"><code>SimSpin.Hernquist</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Hernquist(;dm_mass = 186.9,
            dm_a = 34.5)

Creates a Hernquist analytic dark matter mass potential.
Default values are shown above.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin-Julia/blob/277150c73ff09ea911a019cea516ff7489287ee0/src/types/dark_matter_types.jl#L3-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.NFW" href="#SimSpin.NFW"><code>SimSpin.NFW</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NFW(;dm_vm = 186.9,
        dm_a = 34.5,
        dm_rhof = 0.035)

Creates an NFW analytic dark matter mass potential.
Default values are shown above.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin-Julia/blob/277150c73ff09ea911a019cea516ff7489287ee0/src/types/dark_matter_types.jl#L20-L27">source</a></section></article><h2 id="Multi-Threading-1"><a class="docs-heading-anchor" href="#Multi-Threading-1">Multi-Threading</a><a class="docs-heading-anchor-permalink" href="#Multi-Threading-1" title="Permalink"></a></h2><p>The SimSpin package has multi-threading enabled in some critical functions. To use SimSpin with <code>x</code> threads (where x is the integer number of threads desired) you must call</p><pre><code class="language-none">export JULIA_NUM_THREADS=x</code></pre><p>in a Terminal before the Julia REPL is started. This environment variable defaults to 1 if not set before the session has begun.</p><h2 id="Data-Input-Format-1"><a class="docs-heading-anchor" href="#Data-Input-Format-1">Data Input Format</a><a class="docs-heading-anchor-permalink" href="#Data-Input-Format-1" title="Permalink"></a></h2><p>Here we outline the expected file format accepted by SimSpin.  If you would like to generate this file automatically, a short Python function has been written that uses the <a href="https://github.com/pynbody/pynbody">pynbody</a> package to read in various simulation data types and generate a SimSpin compatible HDF5 file. See <a href="https://github.com/kateharborne/create_SimSpinFile">create_SimSpinFile</a>.</p><p>If you would rather generate the SimSpin file independently, the expected file format is outlined below.</p><pre><code class="language-none">&gt; SimSpin_example.hdf5

&gt;&gt; /PartType0           # Each particle type included in the simulation has its own group.
&gt;&gt;&gt; /PartType0/Mass     # Each group then has a series of data sets assocaited,
&gt;&gt;&gt; /PartType0/vx       #   including the position, velocity and Mass of each particle.
&gt;&gt;&gt; /PartType0/vy
&gt;&gt;&gt; /PartType0/vz
&gt;&gt;&gt; /PartType0/x
&gt;&gt;&gt; /PartType0/y
&gt;&gt;&gt; /PartType0/z

&gt;&gt; /PartType1
&gt;&gt;&gt; ...</code></pre><p>We use the same PartType definition as Gadget: PartTypeX where 0 - gas, 1 - dark matter, 2 - disc, 3 - bulge, 4 - stars. For PartType0-3, each PartType group contains the same data sets as above. If the simulation contains stars, the Age and Metallicity information for each particle is also included:</p><pre><code class="language-none">&gt; SimSpin_example.hdf5
&gt;&gt; /PartType4
&gt;&gt;&gt; /PartType4/Age
&gt;&gt;&gt; /PartType4/Mass
&gt;&gt;&gt; /PartType4/Metallicity
&gt;&gt;&gt; /PartType4/vx        
&gt;&gt;&gt; /PartType4/vy
&gt;&gt;&gt; /PartType4/vz
&gt;&gt;&gt; /PartType4/x
&gt;&gt;&gt; /PartType4/y
&gt;&gt;&gt; /PartType4/z</code></pre><p>If the file is set up in this way, the simulation data can easily be read into the SimSpin package.</p><h3 id="References-1"><a class="docs-heading-anchor" href="#References-1">References</a><a class="docs-heading-anchor-permalink" href="#References-1" title="Permalink"></a></h3><p>A. Pontzen, R Roskar, G. Stinson and R. Woods, (2013), &quot;pynbody: N-Body/SPH analysis for python&quot;,  Astrophysics Source Code Library, record ascl:1305.002</p></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 23 January 2020 03:31">Thursday 23 January 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
